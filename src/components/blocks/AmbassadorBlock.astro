---
/**
 * Single Ambassador Block for Dynamic Zones (SSR Preview)
 * Displays a specific ambassador from the collection
 * Converts markdown description to HTML for preview rendering
 */

import Ambassador from '../ambassadors/Ambassador.astro'
import { parseMarkdown } from '../../utils/mdx'
import type { StrapiAmbassador } from '../ambassadors/types'

interface Props {
  ambassador?: StrapiAmbassador
  showLinks?: boolean
}

const { ambassador, showLinks = true } = Astro.props

// Handle case where ambassador relation isn't populated
if (!ambassador) {
  return null
}

const photoUrl = ambassador.photo?.url
const photoAlt = ambassador.photo?.alternativeText || ambassador.name
// Convert markdown description to HTML for preview
const descriptionHtml = await parseMarkdown(ambassador.description || '')
---

<Ambassador
  name={ambassador.name}
  description={descriptionHtml}
  photo={photoUrl}
  photoAlt={photoAlt}
  linkedinUrl={showLinks ? (ambassador.linkedinUrl ?? undefined) : undefined}
  grantReportUrl={showLinks ? (ambassador.grantReportUrl ?? undefined) : undefined}
/>
