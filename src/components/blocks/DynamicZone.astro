---
import Paragraph from './Paragraph.astro'
import CardsGrid from './CardsGrid.astro'
import CardLinksGrid from './CardLinksGrid.astro'
import Carousel from './Carousel.astro'
import CtaBanner from './CtaBanner.astro'

interface Block {
  __component: string
  [key: string]: unknown
}

interface Props {
  blocks: Block[]
}

const { blocks } = Astro.props

const componentMap: Record<string, typeof Paragraph> = {
  'blocks.paragraph': Paragraph,
  'blocks.cards-grid': CardsGrid,
  'blocks.card-links-grid': CardLinksGrid,
  'blocks.carousel': Carousel,
  'blocks.cta-banner': CtaBanner
}
---

<div class="dynamic-zone">
  {
    blocks.map((block) => {
      const Component = componentMap[block.__component]
      if (!Component) {
        console.warn(`Unknown component type: ${block.__component}`)
        return null
      }
      return (
        <div class="dynamic-zone__block">
          <Component {...block} />
        </div>
      )
    })
  }
</div>

<style>
  .dynamic-zone {
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
  }

  .dynamic-zone__block {
    width: 100%;
  }
</style>
