---
import { getCollection } from 'astro:content'
import BaseLayout from '../../layouts/BaseLayout.astro'
import { createExcerpt } from '../../utils/create-excerpt'

// Only return posts with `draft: true` in the frontmatter
const esEntries = await getCollection('blog', ({ data }) => {
  return data.lang === 'es'
})
---

<BaseLayout
  title="Blog de Ingeniería"
  description="Hear stories and experiences from the team who is working on making Interledger, the interoperable global payments network, a reality."
  ogImageUrl={new URL('/img/blog/og-image.png', Astro.site).href}
>
  <main class="pt-space-m pb-space-xl">
    <div class="mx-auto max-w-content min-w-[360px] max-[1324px]:px-[5%]">
      <ol
        class="flex list-none ps-0 text-step--1 font-bold pt-space-l [&_a]:text-primary [&_a]:no-underline"
        itemscope
        itemtype="https://schema.org/BreadcrumbList"
      >
        <li
          itemprop="itemListElement"
          itemscope
          itemtype="https://schema.org/ListItem"
        >
          <a itemprop="item" href="/" data-umami-event="Devs breadcrumb - Home">
            <span itemprop="name">Developers Portal</span></a
          >
          <meta itemprop="position" content="1" />
        </li>
        <li
          itemprop="itemListElement"
          itemscope
          itemtype="https://schema.org/ListItem"
          class="before:content-['>'] before:inline-flex before:ms-space-3xs"
        >
          <a
            itemprop="item"
            href="/blog"
            data-umami-event="Devs breadcrumb - Blog"
          >
            <span itemprop="name">Engineering Blog</span></a
          >
          <meta itemprop="position" content="2" />
        </li>
      </ol>
      <header class="pt-space-s pb-space-m flex justify-between items-center gap-space-xs max-[730px]:flex-col max-[730px]:items-start">
        <h1>Blog de Ingeniería</h1>
        <a class="group flex items-center gap-space-s rounded bg-white px-space-2xs py-space-3xs shadow text-step--1 no-underline" href="/blog">
          <p class="underline decoration-transparent transition-[text-decoration-color] duration-300 group-hover:decoration-current">
            Check out Foundation updates
          </p>
          <img
            src="/img/ernie-purple.svg"
            alt="Ernie holding an envelope"
            aria-hidden="true"
            class="w-[4em]"
          />
        </a>
      </header>
      <ol class="list-none p-0">
        {
          esEntries.map((blogPostEntry) => {
            const excerpt = `${createExcerpt(blogPostEntry.body).substring(0, 300)}...`
            return (
              <li class="mb-space-s flex flex-col">
                <time
                  class="text-step--1"
                  datetime={blogPostEntry.data.date.toISOString()}
                >
                  {blogPostEntry.data.date.toDateString()}
                </time>
                <a
                  href={`/blog/${blogPostEntry.id}`}
                  class="font-semibold text-primary no-underline underline-offset-4 decoration-transparent transition-[text-decoration-color,color] duration-300 hover:decoration-current"
                >
                  {blogPostEntry.data.title}
                </a>
                <p>
                  {blogPostEntry.data.description
                    ? blogPostEntry.data.description
                    : excerpt}
                </p>
              </li>
            )
          })
        }
      </ol>
    </div>
  </main>
</BaseLayout>
